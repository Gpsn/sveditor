<project name="mk_product" default="mk_product">
	
	<property name="srcdir" value="${basedir}/../"/>
	<property environment="env"/>
	
	<!-- Import the version info -->
	<property file="${basedir}/../sveditor.info"/>
	<property environment="env"/>
	<property name="feature.version" value="${version}"/>

	<property name="buildRoot" location="${basedir}/../buildRoot"/>
	<property name="buildRun" location="${buildRoot}/buildRun"/>
	<property name="build" location="${buildRoot}/build"/>
	<property name="buildResult" location="${basedir}/../buildResult"/>
	<property name="builder" value="${buildRoot}/builder"/>

	<property file="${basedir}/mk_product.properties"/>
	<property file="${basedir}/mk_product_${os}.properties"/>
	<property name="eclipse.home" location="${env.ECLIPSE_HOME}"/>


	<target name="mk_product">

		<delete dir="${buildRoot}"/> 
		<mkdir dir="${buildRoot}"/> 
		<mkdir dir="${buildRun}"/> 
		<mkdir dir="${build}"/> 
		<mkdir dir="${buildResult}"/> 
		<property name="baseLocation" value="${eclipse.home}"/>
		<copy todir="${build}">
			<fileset dir="${srcdir}">
				<include name="plugins/**"/>
				<include name="features/**"/>
				<exclude name="**/*.svn/**"/>
				<exclude name="**/*.git/**"/>
			</fileset>
		</copy>
		<copy todir="${build}" overwrite="true">
			<fileset dir="${srcdir}">
				<include name="features/**/*.xml"/>
				<include name="features/**/*.product"/>
				<include name="plugins/**/*.xml"/>
				<include name="plugins/**/*.MF"/>
				<include name="plugins/**/*.properties"/>
			</fileset>
			<filterset begintoken="1" endtoken="3">
				<filter token=".2." value="${feature.version}"/>
			</filterset>
		</copy>
		<copy file="${basedir}/mk_product_1.xml" todir="${buildRun}"/>
		<ant antfile="${buildRun}/mk_product_1.xml" dir="${buildRun}"/>

		<copy todir="${buildResult}">
			<fileset dir="${build}/I.sve">
				<include name="*.zip"/>
			</fileset>
		</copy>
		<delete dir="${buildRoot}"/>
	</target>

</project>
